Этот подход в количественном анализе (Quantitative Analysis) называется анализом относительной силы (Relative Strength Analysis) или сравнительным анализом корзины активов (Basket Analysis).Если ты нормализуешь OHLC группы высококоррелированных с биткоином альткоинов и наложишь это на график цены BTC, ты получишь мощный инструмент для выявления рыночных аномалий и фаз рынка.Вот подробный научный разбор того, что именно это дает:1. Визуализация "Беты" (Beta) и ВолатильностиДаже если монеты имеют корреляцию близкую к 1 (двигаются в ту же сторону), они имеют разную Бету (коэффициент волатильности относительно бенчмарка).Что увидишь: Нормализованные линии альткоинов будут иметь более высокую амплитуду колебаний, чем линия BTC.Научный смысл: Ты увидишь "рычаг" (leverage) рынка. Если при росте BTC на 1% твоя нормализованная группа растет на 2% (в пересчете на шкалу), значит, аппетит к риску (Risk-On) высокий. Если BTC растет, а группа растет с той же скоростью или медленнее — это сигнал слабости рынка (Risk-Off), инвесторы боятся заходить в "рисковые" активы и сидят в "безопасном" битке.2. Выявление Дивергенций (Расхождений)Это самый ценный сигнал. Так как монеты должны быть коррелированы, любое нарушение этой связи — торговый сигнал.Медвежья дивергенция: BTC делает новый локальный High (цена выше предыдущей вершины), а нормализованная средняя (или совокупность линий) альткоинов не обновляет свой High.Интерпретация: Рост битка не поддерживается широким рынком. Это часто означает "вытягивание" индекса перед падением. Ликвидность не течет в альты, она замыкается в BTC.Бычья дивергенция: BTC падает и делает новый Low, а группа альткоинов удерживает уровень выше предыдущего минимума.Интерпретация: Продавцы в альтах истощились раньше, чем в битке. Это ранний сигнал разворота.3. Отслеживание перетока ликвидности (Rotational Analysis)Нормализация позволяет увидеть, в какой фазе находится рынок:Bitcoin Season: Линия BTC идет вверх круче, чем нормализованный "пучок" альткоинов.Altcoin Season: BTC переходит в боковик (флэт) или медленный рост, а нормализованные линии альтов резко пробивают линию BTC вверх.Total Dump: И BTC, и альты летят вниз, но альты (из-за высокой Беты) летят вниз с опережением.4. Статистический арбитраж (Mean Reversion)Если ты используешь для нормализации Z-Score (стандартную оценку), то:$$Z = \frac{Price - Mean}{StdDev}$$Ты приводишь все монеты к общему знаменателю стандартных отклонений.Что это дает: Если какая-то монета из твоей коррелированной группы отклоняется от линии BTC (например) на 2-3 стандартных отклонения (2-3 сигмы), а исторически они ходят вместе, это математическое обоснование для сделки на возврат к среднему (Mean Reversion). Ты шортишь "выскочку" и лонгуешь "отставшего" (или BTC), ожидая, что спред схлопнется.5. Анализ внутридневной структуры (почему именно OHLC?)Ты упомянул нормализацию не только Close, но и High/Low.Это позволяет построить нормализованные свечи.Сравнивая размер нормализованных теней (High-Low) альткоинов с телом свечи BTC, ты можешь увидеть скрытую волатильность.Например: BTC стоит на месте (маленькое тело свечи), а у нормализованной группы огромные тени (High/Low разброс). Это значит, что внутри рынка идет бешеная борьба и перераспределение позиций ("вытряхивание"), хотя сам индекс (BTC) стоит спокойно. Это предвестник импульса.Как лучше нормализовать (Техническая часть)Чтобы это работало научно, нельзя просто делить цену на максимум. Лучше использовать один из двух методов:Percentage Change (Performance Index): Взять точку отсчета (например, начало месяца) за 0% или 100. Все графики строятся как % изменения от этой точки.Плюс: Легко понять (кто заработал больше %).Минус: Зависит от точки старта.Min-Max Scaler (на скользящем окне): Привести цены к диапазону [0, 1] за последние N баров.Плюс: Показывает положение цены относительно своего недавнего диапазона. Если BTC у верхней границы (1.0), а альты болтаются у 0.5 — это сильная слабость альтов.РезюмеТакой график дает рентген структуры рынка.Ты перестаешь смотреть на цену биткоина как на число. Ты начинаешь смотреть на биткоин как на индекс-бенчмарк, и оцениваешь, насколько остальной рынок "согласен" с движением биткоина.Если согласен и ускоряет движение — тренд сильный.Если не согласен (дивергенция) — тренд ложный или затухающий.



Чтобы построить нормализованную свечу (которая сохранит свою форму — тело, тени, доджи останется доджи), ты должен нормализовать все 4 компонента (Open, High, Low, Close).НО! Тут есть критически важный нюанс.Ты не можешь нормализовать Open относительно истории Open, а High относительно истории High. Если ты так сделаешь, свечу "перекосит", и High может оказаться ниже Open.Главное правило нормализации свечейДля каждой конкретной свечи (в моменте времени $t$) ты должен использовать одни и те же границы диапазона для всех четырех цен.Алгоритм (Скользящее окно 50):Берешь окно из последних 50 свечей.Находишь в этом окне Глобальный Low ($L_{min}$) — это самая низкая точка (из всех Low) за 50 баров.Находишь в этом окне Глобальный High ($H_{max}$) — это самая высокая точка (из всех High) за 50 баров.Вычисляешь Диапазон ($Range$) = $H_{max} - L_{min}$.Теперь нормализуешь все 4 цены текущей свечи, используя эти два числа:$$Norm_{Open} = \frac{Open - L_{min}}{Range}$$$$Norm_{High} = \frac{High - L_{min}}{Range}$$$$Norm_{Low} = \frac{Low - L_{min}}{Range}$$$$Norm_{Close} = \frac{Close - L_{min}}{Range}$$Что это дает визуально?Сохранение пропорций: Если у реальной свечи была огромная тень сверху, у нормализованной свечи она тоже будет огромной (относительно диапазона).Контекст:Если вся свеча (и O, и H, и L, и C) получилась в районе 0.9–1.0, значит, монета торгуется на своих хаях за последние 50 периодов.Если свеча сплюснута в узкую полоску, значит, волатильность этой конкретной минуты ничтожна по сравнению с тем, что было 20 минут назад.Реализация на C++ (Свечная нормализация)Вот скорректированный код, который делает именно это. Он берет вектор сырых свечей и возвращает вектор нормализованных свечей, готовых к отрисовке.C++#include <vector>
#include <algorithm>
#include <iostream>
#include <cmath> // Для std::abs

struct Candle {
    double open, high, low, close;
};

// Структура для нормализованной свечи (значения 0.0 - 1.0)
struct NormCandle {
    double n_open, n_high, n_low, n_close;
};

std::vector<NormCandle> normalizeCandlesRolling(const std::vector<Candle>& rawData, int windowSize = 50) {
    std::vector<NormCandle> result;
    
    // Если данных мало, возвращаем пустой вектор (или можно заполнить нулями)
    if (rawData.empty()) return result;

    for (size_t i = 0; i < rawData.size(); ++i) {
        // 1. Определяем начало окна
        // Если мы на 5-й свече, а окно 50, берем с 0-й по 5-ю.
        size_t start = (i >= windowSize) ? (i - windowSize + 1) : 0;
        
        // 2. Ищем ГЛОБАЛЬНЫЕ High и Low внутри этого окна
        double windowMin = rawData[start].low;
        double windowMax = rawData[start].high;

        for (size_t j = start; j <= i; ++j) {
            if (rawData[j].low < windowMin) windowMin = rawData[j].low;
            if (rawData[j].high > windowMax) windowMax = rawData[j].high;
        }

        double range = windowMax - windowMin;
        
        // Защита от деления на ноль (если цена стояла колом 50 баров)
        if (range <= 1e-9) range = 1.0; 

        // 3. Нормализуем ВСЕ ЧЕТЫРЕ компонента по одной шкале
        NormCandle nc;
        nc.n_open  = (rawData[i].open - windowMin) / range;
        nc.n_high  = (rawData[i].high - windowMin) / range;
        nc.n_low   = (rawData[i].low - windowMin)  / range;
        nc.n_close = (rawData[i].close - windowMin) / range;
        
        result.push_back(nc);
    }
    
    return result;
}
Как с этим работать дальше (Агрегация корзины)Если ты хочешь построить одну "Среднюю Альтовую Свечу" из группы монет (например, ETH, SOL, BNB), ты делаешь так:Прогоняешь этот код для каждой монеты отдельно. Получаешь vector<NormCandle> для ETH, для SOL и т.д.Для каждого временного шага $t$ усредняешь их нормализованные значения:$AvgOpen_t = (NormOpen_{ETH} + NormOpen_{SOL} + ...) / N$$AvgHigh_t = (NormHigh_{ETH} + NormHigh_{SOL} + ...) / N$... и так далее.В итоге ты получишь Синтетическую свечу, которая показывает, где находится весь рынок альткоинов относительно своих 50-барных диапазонов. Это очень мощный инструмент.
